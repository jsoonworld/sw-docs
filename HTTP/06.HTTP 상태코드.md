# HTTP 상태코드

## State Code
### 클라이언트가 보낸 요청의 처리 상태를 응답에서 알려주는 기능

- 1xx (Informational): 요청이 수신되어 처리중 
- 2xx (Successful): 요청 정상 처리 
- 3xx (Redirection): 요청을 완료하려면 추가 행동이 필요 
- 4xx (Client Error): 클라이언트 오류, 잘못된 문법등으로 서버가 요청을 수행할 수 없음 
- 5xx (Server Error): 서버 오류, 서버가 정상 요청을 처리하지 못함

## 1xx (Informational)
### 요청이 수신되어 처리중
- 거의 사용하지 않으므로 생략


## 2xx (Successful)
### 클라이언트의 요청을 성공적으로 처리
- 200 OK 
- 201 Created 
- 202 Accepted 
- 204 No Content

## 200 OK (성공)
### `200 OK` 상태 코드는 요청이 성공적으로 처리되었음을 나타냄.

- GET: 자원이 가져와져서 메시지 바디에 전달됨.
- HEAD: 엔티티 헤더가 메시지 바디에 있다.

```
요청:
GET /members/100 HTTP/1.1
Host: localhost:8080

응답:
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 34

{
  "username": "young",
  "age": 20
}
```

## 201 Created (생성됨)
### `201 Created` 상태 코드는 요청이 이행되었고 새로운 리소스가 생성되었음을 나타냄. 
새로 생성된 리소스는 응답의 엔티티에 있는 URI를 통해 참조될 수 있으며, 리소스에 대한 가장 구체적인 
URI는 Location 헤더 필드에 의해 제공됨.

```
요청:
POST /members HTTP/1.1
Content-Type: application/json

{
  "username": "young",
  "age": 20
}

응답:
HTTP/1.1 201 Created
Content-Type: application/json
Content-Length: 34
Location: /members/100

{
"username": "young",
"age": 20
}
```



### 202 Accepted (수락됨)
 `202 Accepted` 상태 코드는 요청이 처리를 위해 
 수락되었지만 처리가 완료되지 않았음을 나타냄. 
 요청은 처리될 수도 있고, 
 실제 처리가 이루어질 때 거부될 수도 있다.


**예시 설명:**
- 배치 처리 작업에 사용됨.
- 응답이 전송된 후 어느 시점에 실제 처리가 이루어질 수 있다.

### 204 No Content (콘텐츠 없음)
`204 No Content` 상태 코드는 서버가 요청을 성공적으로 처리했으나,
콘텐츠를 반환하지 않음을 나타냄. 
이는 클라이언트가 현재 페이지를 벗어나지 않아도 되는 작업, 
예를 들어 AJAX 연산과 같은 경우에 주로 사용됨.

**예시 설명:**
- 브라우저가 현재 페이지에 머물러야 할 때 사용됨.
- '저장' 버튼의 동작이 페이지 이동을 발생시키지 않을 때 사용됨.
- 저장 작업에 부수적인 효과가 있더라도 사용자는 현재 페이지에 머물러 있는다.
- 콘텐츠가 반환되지 않더라도 클라이언트의 현재 페이지는 변하지 않는다.


## 3xx (Redirection)
### 요청을 완료하기 위해 유저 에이전트의 추가 조치 필요
- 300 Multiple Choices 
- 301 Moved Permanently 
- 302 Found 
- 303 See Other 
- 304 Not Modified 
- 307 Temporary Redirect 
- 308 Permanent Redirect

## 리다이렉션 이해

리다이렉션은 웹 서버가 클라이언트의 요청을 받고, 
요청된 페이지가 다른 URL로 옮겨졌을 때 클라이언트를 
해당 URL로 안내하는 과정이다.

## 영구 리다이렉션 (Permanent Redirect)
- `301 Moved Permanently`: 요청된 리소스가 영구적으로 
새로운 URI로 이동했을 때 사용된다.
검색 엔진이나 브라우저는 이 정보를 기억하고, 
후속 요청을 새로운 URI로 자동으로 보낸다.
- `308 Permanent Redirect`: 301과 같은 목적으로 사용되지만,
308은 원래 요청의 메서드와 본문을 변경하지 않음을 보장한다.

**예시:**
자동 리다이렉트를 통해 클라이언트는 최초에
`/event`를 요청했지만, 
서버가 `301 Moved Permanently` 
상태 코드와 함께 `Location: /new-event` 
헤더를 반환하여, 
클라이언트는 새로운 URI `/new-event`로 자동 리다이렉트 된다.

```plaintext
GET /event HTTP/1.1
Host: localhost:8080

HTTP/1.1 301 Moved Permanently
Location: /new-event

GET /new-event HTTP/1.1
Host: localhost:8080

HTTP/1.1 200 OK
```

## 일시적 리다이렉션 (Temporary Redirect)
- `302 Found`: 요청된 리소스가 일시적으로 다른 URI에 위치해 있다는 것을 나타낸다. 
이 상태 코드는 GET 메서드로 자동 리다이렉션될 수 있다.
- `303 See Other`: 302와 유사하지만, GET 메서드로의 리다이렉션을 강제합니다. 주로 POST 요청에 대한 응답으로 사용된다.
- `307 Temporary Redirect`: 302와 유사하지만, 307은 원래 HTTP 요청 메서드를 유지해야 한다는 점에서 차이가 있다.


**예시**:
POST 요청이 있을 때, 서버는 303 See Other 상태 코드를 반환하고, Location 헤더로 클라이언트를 다른 페이지로 안내할 수 있다. 
이후 클라이언트는 GET 메서드로 해당 위치로 리다이렉션된다.

```
POST /event HTTP/1.1
Host: localhost:8080
name=hello&age=20

HTTP/1.1 303 See Other
Location: /new-event
GET /new-event HTTP/1.1
Host: localhost:8080

HTTP/1.1 200 OK
```


# PRG: Post/Redirect/Get 패턴

PRG는 "Post/Redirect/Get"의 약자로, 웹 개발에서 사용자가 웹 폼에 데이터를 제출한 후 발생할 수 있는 중복 제출 문제를 방지하는 
웹 애플리케이션 디자인 패턴이다.

## PRG 패턴의 작동 방식
1. 사용자가 서버로 데이터를 전송하는 `POST` 요청을 보낸다.
2. 서버는 데이터를 처리한 후, `302 Found`와 같은 리다이렉션을 사용하여 브라우저에게 다른 페이지로 이동하도록 지시한다. 
이 때 `Location` 헤더를 사용해 리다이렉트 대상 URL을 전달한다.
3. 브라우저는 서버로부터 받은 리다이렉션 응답을 따라 `GET` 요청을 새로운 URL로 보낸다.
4. 서버는 `GET` 요청에 대해 요청된 페이지를 반환하고, 이 과정에서 `POST`로 인한 중복 제출이 발생하지 않는다.

이 패턴은 웹 폼 제출 후 새로 고침 버튼을 눌렀을 때 동일한 폼 데이터가 서버에 다시 제출되는 것을 방지한다.

**예시:**
```plaintext
POST /order HTTP/1.1
Host: localhost:8080
itemId=mouse&count=1

HTTP/1.1 302 Found
Location: /order-result/19
```

브라우저는 /order-result/19에 대한 GET 요청을 보낸다.
```
GET /order-result/19 HTTP/1.1
Host: localhost:8080

HTTP/1.1 200 OK
```
브라우저는 서버의 지시에 따라 새 URL로 리다이렉트 된다. 
사용자가 이 페이지를 새로 고침하더라도, POST 요청이 재전송되지 않으므로 중복 주문의 위험이 없다.

## PRG 패턴의 이점
- 중복 제출 방지: PRG 패턴을 사용하면 사용자가 실수로 또는 의도적으로 페이지를 
새로 고침하거나 다시 로드했을 때 폼 데이터가 중복으로 제출되는 것을 방지할 수 있다.
- 사용자 경험 개선: 사용자가 성공적으로 작업을 완료했다는 확신을 주고, 
브라우저의 불필요한 경고 메시지를 방지하여 사용자 경험을 개선한다.
- 데이터 처리의 명확성: 데이터 처리 후 적절한 페이지로 안내함으로써, 
사용자가 자신의 요청이 성공적으로 처리되었는지 명확하게 인지할 수 있다.

# 그래서 뭘 써야 하나요? 리다이렉션과 캐싱에 관한 HTTP 상태 코드

## 리다이렉션 관련 코드: 302, 307, 303
리다이렉션은 서버가 클라이언트의 요청을 새로운 URL로 안내하는 방법이다.

### 상태 코드 설명
- `302 Found`: 클라이언트가 GET으로 임시 리다이렉트를 따를 수 있음.
- `307 Temporary Redirect`: 메서드를 변경하지 않고 임시 리다이렉트를 수행.
- `303 See Other`: 클라이언트가 GET으로 리다이렉트를 따르도록 강제.

### 사용 시 고려 사항
- 첫 번째 요청이 POST인 경우, 리다이렉트를 따르는 요청은 GET이어야 함.
- 리다이렉트 응답이 POST 이후에 올 때, 이를 GET 요청으로 처리하는 것이 일반적.

### 결론
- `307`과 `303`은 클라이언트가 원래 HTTP 메서드를 변경하지 않고 리다이렉트를 따를 것을 보장함.
- `302`는 역사적으로 GET 리다이렉트로만 사용되지만, 클라이언트가 다른 메서드로 요청을 재전송할 가능성이 있음.

## 캐싱 관련 코드: 300, 304
캐싱은 서버의 부하를 줄이고, 클라이언트의 로딩 속도를 향상시키는 중요한 기능이다.

### 상태 코드 설명
- `300 Multiple Choices`: 여러 옵션이 있음을 나타냄.
- `304 Not Modified`: 리소스가 수정되지 않았다면, 캐시된 버전을 사용할 것을 나타냄.

### 사용 시 고려 사항
- `300`은 클라이언트에게 여러 리소스 중 하나를 선택할 옵션을 제공함.
- `304`는 클라이언트의 캐시가 여전히 유효함을 나타냄, 그러므로 네트워크 트래픽을 줄임.

### 결론
- `304`는 서버가 콘텐츠를 다시 전송하지 않고, 클라이언트가 캐시를 재사용하도록 함으로써 네트워크 트래픽과 로딩 시간을 절약함.
- 일반적으로 `GET`, `HEAD` 요청에 대한 응답으로 사용됨.

# 4xx (Client Error) HTTP 상태 코드

클라이언트 오류 상태 코드는 클라이언트의 잘못된 요청으로 인해 서버가 요청을 수행할 수 없을 때 반환된다. 
오류의 원인은 클라이언트에 있다.

## 400 Bad Request
`400 Bad Request`는 서버가 요청을 이해할 수 없음을 나타내며, 
클라이언트는 요청을 수정하지 않고서는 동일한 요청을 반복해서 보내서는 안 된다. 
이 오류는 주로 잘못된 요청 구문, 크기가 너무 큰 요청, 또는 처리할 수 없는 요청 데이터로 인해 발생한다.
예를 들어, 클라이언트가 잘못된 데이터 형식을 보냈거나, API 스펙에 맞지 않는 요청을 할 때 발생할 수 있다.


## 401 Unauthorized
`401 Unauthorized` 오류는 요청이 인증을 필요로 할 때 발생한다. 클라이언트는 요청과 함께 유효한 인증 자격 증명을 제공해야 한다. 
이 상태 코드는 주로 인증이 필요한 리소스에 대한 액세스를 시도했을 때 서버가 클라이언트에게 인증을 요구하는 경우에 반환된다.


## 403 Forbidden
`403 Forbidden` 오류는 서버가 요청을 이해했지만, 
클라이언트가 해당 리소스에 대한 액세스 권한이 없음을 나타낸다.
이 상태 코드는 인증이 성공적으로 이루어졌지만, 인증된 사용자에게 필요한 권한이 없는 경우에 반환된다.

## 404 Not Found
`404 Not Found`는 클라이언트가 요청한 리소스를 서버에서 찾을 수 없음을 나타낸다.
이 오류는 URL이 잘못되었거나 리소스가 서버에서 삭제되었거나 이동되었을 때 발생한다.

이러한 상태 코드는 클라이언트에서 발생한 문제를 지정하며, 
각 코드는 서버가 클라이언트에게 어떤 종류의 조치를 취해야 하는지에 대한 힌트를 제공한다.

# 5xx (Server Error) HTTP 상태 코드

5xx 오류 코드는 서버에서 클라이언트의 요청을 처리하는 도중 문제가 발생했음을 나타낸다. 
이 오류들은 서버가 요청을 수행할 수 없을 때, 즉 서버 내부에 문제가 있을 때 발생한다.

## 500 Internal Server Error
`500 Internal Server Error`는 서버 내부에 오류가 발생하여 요청을 수행할 수 없을 때 사용되는 응답이다. 
이는 서버에 문제가 있음을 나타내며, 클라이언트가 요청을 개선할 수 있는 방법은 없다. 오류의 원인을 파악하고 수정하는 것은 서버 관리자의 책임이다.

## 503 Service Unavailable
`503 Service Unavailable` 오류는 서버가 일시적으로 요청을 처리할 능력이 없음을 나타낸다.
이는 주로 서버가 과부하 상태거나 유지 보수로 인해 일시적으로 요청을 처리할 수 없을 때 발생한다. 
`Retry-After` 헤더를 포함하여 클라이언트에게 언제 요청을 다시 시도할 수 있는지 알려줄 수 있다.




















